class SelectorsForm{constructor(t){this.form=document.querySelector(t.form),this.focusType=t.typeEventFocus,this.selectHeader=t.selectHeader,this.selectItem=t.selectItem,this.selectBody=t.selectBody,this.selectList=Array.from(this.form.querySelectorAll(t.selectList)),this.select=t.select,this.submit=this.form.querySelector(t.submit),this.shake=t.shake,this.svg=this.form.querySelector(t.classSvg),this.validation=t.validation,this.validText=t.validText,this.validNo=t.validNo,this.password=this.form.querySelector(t.password),this.passwordConfirm=this.form.querySelector(t.passwordConfirm),this.inputAll=Array.from(this.form.querySelectorAll(t.input)),this.inputType=t.typeEventInput,this.inputBox=t.inputBox,this.iconBlock=t.iconBlock,this.iconCheck=t.iconCheck,this.iconEye=t.iconEye,this.iconEyeBlocked=t.iconEyeBlocked,this.interval=t.interval,this.checkValueForEventFocus=t.checkValueForEventFocus,this.checkValueForEventInput=t.checkValueForEventInput,this.classAnimateBox=t.classAnimateBox,this.classAnimateSvg=t.classAnimateSvg,this.registered=this.form.querySelector(t.registered),this.timeVisibRegist=t.timeVisibRegist,this.header=this.form.querySelector(t.header),this.btnAnimate=this.form.querySelector(t.btnAnimate)}get selectHeaderAll(){return Array.from(this.form.querySelectorAll(`.${this.selectHeader}`))}getBlock(t,s){return t.closest(this.validation).querySelector(s)}checkValueSelector(){this.selectHeaderAll.forEach((t=>{t.innerText||(this.getBlock(t,this.validText).style.display="block",this.getBlock(t,`.${this.select}`).classList.add(this.validNo))}))}checkValueInput(){this.inputAll.forEach((t=>{t.value||(this.getBlock(t,this.validText).style.display="block",t.classList.add(this.validNo))}))}}class CheckValueAllSelectors extends SelectorsForm{constructor(t){super(t)}checkValue(t,s){s.value?s.value.match(t.patternReg)?(s.classList.contains(this.validNo)&&(s.classList.remove(this.validNo),this.getBlock(s,this.validText).style.display="none"),t.iconClass&&this.getBlock(s,this.iconBlock).classList.add(t.iconClass)):(s.classList.contains(this.validNo)||s.classList.add(this.validNo),this.getBlock(s,this.validText).style.display="block"):s.classList.contains(this.validNo)&&(s.classList.remove(this.validNo),this.getBlock(s,this.validText).style.display="none")}}class CheckPassword extends CheckValueAllSelectors{constructor(t){super(t)}passwordConfirmOnLock(){this.password.value?this.passwordConfirm.disabled=0:this.passwordConfirm.disabled=1}contrastPassword(){if(this.password.value&&this.passwordConfirm.value){let t=this.getBlock(this.passwordConfirm,this.iconBlock);this.password.value==this.passwordConfirm.value?(t.classList.add(this.iconCheck),this.passwordConfirm.classList.contains(this.validNo)&&(this.passwordConfirm.classList.remove(this.validNo),this.getBlock(this.passwordConfirm,this.validText).style.display="none")):(t.classList.contains(this.iconCheck)&&t.classList.remove(this.iconCheck),this.passwordConfirm.classList.contains(this.validNo)||this.passwordConfirm.classList.add(this.validNo))}else this.passwordConfirm.value||this.passwordConfirm.classList.contains(this.validNo)&&(this.passwordConfirm.classList.remove(this.validNo),this.getBlock(this.passwordConfirm,this.validText).style.display="none")}addEye(){let t=this.getBlock(this.password,this.iconBlock);this.password.value?t.classList.contains(this.iconEye)||t.classList.contains(this.iconEyeBlocked)||t.classList.add(this.iconEye):this.password.value||(t.classList.contains(this.iconEye)&&t.classList.remove(this.iconEye),t.classList.contains(this.iconEyeBlocked)&&(t.classList.remove(this.iconEyeBlocked),this.password.type="password",this.passwordConfirm.type="password"))}}class EventBlock extends CheckPassword{constructor(t){super(t),this.eventInput(this.checkValueForEventInput,this.inputType),this.eventInput(this.checkValueForEventFocus,this.focusType),this.clickEye(),this.eventInputConfirm(),this.eventSelect()}eventInput(t,s){t.forEach((t=>{let e=this.form.querySelector(t.selector);e.addEventListener(`${s}`,(()=>{this.passwordConfirmOnLock(),this.addEye(),this.checkValue(t,e)}))}))}eventSelect(){this.selectList.forEach((t=>{t.addEventListener("click",(()=>{let s=this.getBlock(t,`.${this.select}`);this.getBlock(t,`.${this.selectHeader}`).innerText&&s.classList.contains(this.validNo)&&(this.getBlock(t,this.validText).style.display="none",s.classList.remove(this.validNo))}))}))}eventInputConfirm(){this.passwordConfirm.addEventListener("input",(()=>{this.contrastPassword()}))}clickEye(){let t=this.getBlock(this.password,this.iconBlock);t.addEventListener("click",(()=>{"password"==this.password.type?(this.password.type="text",this.passwordConfirm.type="text",t.classList.remove(this.iconEye),t.classList.add(this.iconEyeBlocked)):"text"==this.password.type&&(this.password.type="password",this.passwordConfirm.type="password",t.classList.remove(this.iconEyeBlocked),t.classList.add(this.iconEye))}))}}class SubmitForm extends EventBlock{constructor(t){super(t),this.submitForm(),this.getAnimate(),this.visibilityOnLoad()}get arrayBlocks(){let t=Array.from(this.form.querySelectorAll(this.inputBox));return t.push(this.btnAnimate),t.unshift(this.header),t}submitForm(){document.querySelector("form").addEventListener("submit",(t=>{t.preventDefault();let s=new FormData(this.form);this.checkValueSelector(),this.checkValueInput(),this.form.querySelectorAll(`.${this.validNo}`).length?(this.submit.classList.add(this.shake),this.shakeNot()):(this.visibility(this.svg,this.classAnimateSvg),this.arrayBlocks.forEach((t=>{this.visibility(t,this.classAnimateBox)})),this.visibilityTimeOut(s))}))}NameValueOfSelect(t){return this.selectHeaderAll.forEach((s=>{let e=s.innerText,i=s.getAttribute("data-name");t.append(i,e)})),t}shakeNot(){setTimeout((()=>{this.submit.classList.remove(this.shake)}),800)}visibility(t,s){t.classList.toggle(s)}removeValue(){this.selectHeaderAll.forEach((t=>{t.innerText=""})),this.inputAll.forEach((t=>{t.value="";let s=this.getBlock(t,this.iconBlock);s&&(s.classList.contains(this.iconCheck)&&s.classList.remove(this.iconCheck),s.classList.contains(this.iconEyeBlocked)&&s.classList.remove(this.iconEyeBlocked),s.classList.contains(this.iconEye)&&s.classList.remove(this.iconEye))}))}visibilityOnLoad(){this.visibility(this.svg,this.classAnimateSvg);let t=1,s=this.arrayBlocks.length;this.arrayBlocks.forEach((e=>{this.visibility(e,this.classAnimateBox),s-=1,t+=this.interval,e.style.zIndex=s,e.style.animationDelay=`${t}s`}))}async visibilityTimeOut(t){(await fetch("php/server.php",{method:"POST",body:this.NameValueOfSelect(t)})).ok&&(this.visibility(this.registered,this.classAnimateBox),setTimeout((()=>{this.visibility(this.registered,this.classAnimateBox),this.removeValue(),this.passwordConfirmOnLock(),this.visibilityOnLoad()}),this.timeVisibRegist))}getAnimate(){let t=this.form.querySelector("#iconPath").getTotalLength();this.svg.setAttribute("stroke-dashoffset",t),this.svg.setAttribute("stroke-dasharray",t)}}class RenderSelect extends SubmitForm{constructor(t){super(t),this.wayServer=t.wayServer,this.idDay=this.form.querySelector(t.idDay),this.idYear=this.form.querySelector(t.idYear),this.idMonth=this.form.querySelector(t.idMonth),this.idNationality=this.form.querySelector(t.idNationality),this._fetchData()}_fetchData(){fetch(this.wayServer).then((t=>t.json())).then((t=>{this.dataServer=t,this.addElement(this.idDay,this.inArrayNum(this.dataServer.day)),this.addElement(this.idYear,this.inArrayNum(this.dataServer.year)),this.addElement(this.idMonth,this.dataServer.month),this.addElement(this.idNationality,this.dataServer.nationality),this.clickAddText()})).catch((t=>{console.log(t)}))}inArrayNum(t){let s=[];for(let e=t[1];e>=t[0];e--)s.push(e);return s}render(t){return`<li class="select__item">${t}</li>`}addElement(t,s){let e=t.querySelector(".select__list");s.forEach((t=>{e.insertAdjacentHTML("beforeend",this.render(t))}))}}class SelectForm extends RenderSelect{constructor(t){super(t),this.clickOutside(),this.clickOpen()}get selectItemsArr(){return this.form.querySelectorAll(`.${this.selectItem}`)}clickOutside(){window.addEventListener("click",(t=>{t.target.classList.contains(this.selectHeader)||t.target.classList.contains(this.selectItem)||this.closeAll()}))}clickOpen(){this.selectHeaderAll.forEach((t=>{t.addEventListener("click",(t=>{this.selectToggle(t.target)}))}))}clickAddText(){this.selectItemsArr.forEach((t=>{t.addEventListener("click",(t=>{this.selectChoose(t.target)}))}))}closeAll(t=null){this.form.querySelectorAll(`.${this.select}`).forEach((s=>{let e=s.querySelector(`.${this.selectHeader}`),i=s.querySelector(`.${this.selectBody}`);i.classList.contains("_is-active")&&t!=e&&(i.classList.remove("_is-active"),e.classList.remove("_rotate"))}))}selectToggle(t){this.closeAll(t),t.classList.toggle("_rotate"),t.nextElementSibling.classList.toggle("_is-active")}selectChoose(t){let s=t.innerText,e=t.closest(".select"),i=e.querySelector(".select__header"),o=e.querySelector(".select__body");i.innerText=s,o.classList.remove("_is-active"),i.classList.remove("_rotate")}}let valueForm=new SelectForm({form:".form-signUp",input:"._input",selectHeader:"select__header",validation:".validation",select:"select",selectList:".select__list",selectBody:"select__body",selectItem:"select__item",validText:".validation__text",validNo:"_valid-no",password:"#password",passwordConfirm:"#confirm-password",iconBlock:".validation__icon",iconCheck:"_icon-check-mail",iconEye:"_icon-eye",iconEyeBlocked:"_icon-eye-blocked",submit:"#submit",shake:"_shake",typeEventInput:"input",typeEventFocus:"focusout",header:".form-signUp__header",inputBox:".input-signUp__box",btnAnimate:".submit-signUp__animateBtn",registered:".registered",timeVisibRegist:4e3,interval:.3,classAnimateSvg:"_animate-svg",classAnimateBox:"_animate-box",classSvg:".form-signUp__svg",wayServer:"json/select.json",idDay:"#day",idYear:"#year",idMonth:"#month",idNationality:"#nationality",checkValueForEventInput:[{selector:"#email",patternReg:"^[a-z0-9](.?[a-z0-9]){5,}@yahoo.com$",iconClass:"_icon-check-mail"},{selector:"#password",patternReg:"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])([a-zA-Z0-9]{8,})$",iconClass:!1}],checkValueForEventFocus:[{selector:"#name",patternReg:"[A-Za-zА-Яа-яЁё]{3,20}",iconClass:!1},{selector:"#last-name",patternReg:"[A-Za-zА-Яа-яЁё]{3,20}",iconClass:!1}]});